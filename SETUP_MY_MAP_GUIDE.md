# ë‚˜ì˜ ì§€ë„ ì‹¤ì œ ë°ì´í„° ì—°ë™ - ì™„ë²½ ê°€ì´ë“œ

## ğŸ¯ í˜„ì¬ ìƒí™©

### âœ… ì™„ë£Œëœ ì‘ì—…
1. **ìƒˆë¡œìš´ ì‹¤ì œ ë°ì´í„° í˜ì´ì§€ ìƒì„±** (`/my-map-real`)
   - 100% ì‹¤ì œ DB ì—°ë™
   - Mock ë°ì´í„° ì™„ì „ ì œê±°
   - Canvas ê¸°ë°˜ ì¸í„°ë™í‹°ë¸Œ ì§€ë„
   - ì‹¤ì‹œê°„ í†µê³„ ëŒ€ì‹œë³´ë“œ

2. **ë°±ì—”ë“œ API ì™„ì„±**
   - `GET /api/v1/visits/{user_id}` - ë°©ë¬¸ ê¸°ë¡ ì¡°íšŒ
   - `POST /api/v1/visits` - ë°©ë¬¸ ê¸°ë¡ ìƒì„±
   - ìë™ XP ê³„ì‚° ë¡œì§

3. **ë©”ì¸ ì•± í†µí•©**
   - "ë‚˜ì˜ ì§€ë„" ë²„íŠ¼ â†’ `/my-map-real` ì—°ê²°
   - ì „ì²´ ì„œë¹„ìŠ¤ì™€ ìƒí˜¸ì‘ìš© ì¤€ë¹„ ì™„ë£Œ

### â³ í•„ìš”í•œ ì‘ì—… (ë‹¨ 1ë‹¨ê³„!)

**Supabaseì—ì„œ visits í…Œì´ë¸” ìƒì„±** (5ë¶„ ì†Œìš”)

## ğŸš€ ì„¤ì • ë°©ë²•

### 1ë‹¨ê³„: Supabase ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰

1. **Supabase ëŒ€ì‹œë³´ë“œ ì ‘ì†**
   ```
   https://supabase.com/dashboard
   ```

2. **WhereHere í”„ë¡œì íŠ¸ ì„ íƒ**

3. **SQL Editor ë©”ë‰´ í´ë¦­**
   - ì™¼ìª½ ì‚¬ì´ë“œë°”ì—ì„œ "SQL Editor" ì°¾ê¸°

4. **New Query í´ë¦­**

5. **ì•„ë˜ íŒŒì¼ ë‚´ìš© ë³µì‚¬**
   - íŒŒì¼: `supabase/migrations/CREATE_VISITS_TABLE.sql`
   - ì „ì²´ ë‚´ìš© ë³µì‚¬ (Ctrl+A, Ctrl+C)

6. **ë¶™ì—¬ë„£ê¸° í›„ RUN í´ë¦­**
   - í•˜ë‹¨ì— "Success" ë©”ì‹œì§€ í™•ì¸

7. **ê²°ê³¼ í™•ì¸**
   ```sql
   SELECT * FROM visits LIMIT 5;
   ```
   - ìƒ˜í”Œ ë°ì´í„° 7ê°œ í™•ì¸ (user-demo-001)

### 2ë‹¨ê³„: ì•± í…ŒìŠ¤íŠ¸

1. **ë°±ì—”ë“œ ì‹¤í–‰ í™•ì¸**
   ```powershell
   # ì´ë¯¸ ì‹¤í–‰ ì¤‘ì´ë©´ ìƒëµ
   cd backend
   python -m uvicorn main:app --reload --port 8000
   ```

2. **í”„ë¡ íŠ¸ì—”ë“œ ì‹¤í–‰**
   ```powershell
   cd frontend-app
   npm run dev
   ```

3. **ë‚˜ì˜ ì§€ë„ ì ‘ì†**
   ```
   http://localhost:3003/my-map-real
   ```

4. **í™•ì¸ ì‚¬í•­**
   - âœ… ë¡œë”© í›„ ì§€ë„ í‘œì‹œ
   - âœ… 7ê°œ ë°©ë¬¸ ë§ˆì»¤ í‘œì‹œ
   - âœ… í†µê³„ íƒ­ì—ì„œ ì¹´í…Œê³ ë¦¬ ë¶„í¬ í™•ì¸
   - âœ… ìŠ¤íƒ€ì¼ íƒ­ì—ì„œ AI ë¶„ì„ í™•ì¸

## ğŸ“± ì£¼ìš” ê¸°ëŠ¥

### ì§€ë„ íƒ­
- **ì¸í„°ë™í‹°ë¸Œ ì§€ë„**: ë°©ë¬¸ ê²½ë¡œ ì‹œê°í™”
- **í´ë¦­ ê°€ëŠ¥í•œ ë§ˆì»¤**: ìƒì„¸ ì •ë³´ í‘œì‹œ
- **ìµœê·¼ ë°©ë¬¸ ëª©ë¡**: ì‹œê°„ìˆœ ì •ë ¬
- **ì‹¤ì‹œê°„ í†µê³„**: ì´ ë°©ë¬¸, íƒí—˜ ë°˜ê²½, ì´ XP

### í†µê³„ íƒ­
- **ì¹´í…Œê³ ë¦¬ ë¶„í¬**: ë°©ë¬¸í•œ ì¥ì†Œ ìœ í˜•ë³„ í†µê³„
- **í‰ê·  ì²´ë¥˜ ì‹œê°„**: ì¥ì†Œë³„ í‰ê·  ë¨¸ë¬¸ ì‹œê°„
- **í‰ê·  ë¹„ìš©**: ë°©ë¬¸ë‹¹ í‰ê·  ì§€ì¶œ
- **ì„ í˜¸ ì‹œê°„ëŒ€**: ì£¼ë¡œ ë°©ë¬¸í•˜ëŠ” ì‹œê°„

### ìŠ¤íƒ€ì¼ íƒ­
- **AI íƒí—˜ ìŠ¤íƒ€ì¼ ë¶„ì„**: ì‚¬ìš©ì ì„±í–¥ ë¶„ì„
- **ì„ í˜¸ ì¹´í…Œê³ ë¦¬**: ê°€ì¥ ë§ì´ ë°©ë¬¸í•œ ì¹´í…Œê³ ë¦¬
- **ë§ì¶¤ ì¶”ì²œ**: íŒ¨í„´ ê¸°ë°˜ ì¶”ì²œ

## ğŸ”— ì „ì²´ ì„œë¹„ìŠ¤ í†µí•©

### í˜„ì¬ êµ¬ì¡°

```
ë©”ì¸ ì•± (/)
  â†“
ì—­í•  ì„ íƒ (íƒí—˜ê°€, íëŸ¬, ì˜ˆìˆ ê°€...)
  â†“
ê¸°ë¶„ ì„ íƒ (í˜¸ê¸°ì‹¬, í”¼ê³¤í•¨...)
  â†“
AI ì¶”ì²œ (3ê°œ ì¥ì†Œ)
  â†“
í€˜ìŠ¤íŠ¸ ìˆ˜ë½
  â†“
[í–¥í›„] ë°©ë¬¸ ì™„ë£Œ ì²´í¬ì¸
  â†“
ë‚˜ì˜ ì§€ë„ (/my-map-real) â† ì‹¤ì œ ë°ì´í„° í‘œì‹œ
```

### ë°ì´í„° íë¦„

```
1. ì‚¬ìš©ìê°€ ì¶”ì²œ ì¥ì†Œ ë°©ë¬¸
   â†“
2. [í–¥í›„] ì²´í¬ì¸ ë²„íŠ¼ í´ë¦­
   â†“
3. POST /api/v1/visits
   â†“
4. Supabase visits í…Œì´ë¸”ì— ì €ì¥
   â†“
5. ìë™ XP ê³„ì‚° (100-180)
   â†“
6. ë‚˜ì˜ ì§€ë„ì—ì„œ ì¦‰ì‹œ ë°˜ì˜
```

## ğŸ® ê²Œì„í™” ìš”ì†Œ

### XP ì‹œìŠ¤í…œ
```python
ê¸°ë³¸ XP: 100
+ ì²´ë¥˜ ì‹œê°„ 60ë¶„ ì´ìƒ: +50
+ í‰ì  4.0 ì´ìƒ: +30
= ì´ XP: 100 ~ 180
```

### ë ˆë²¨ ì‹œìŠ¤í…œ (í–¥í›„)
```
Level 1: 0 - 500 XP (ì´ˆë³´ íƒí—˜ê°€)
Level 2: 500 - 1500 XP (ìˆ™ë ¨ íƒí—˜ê°€)
Level 3: 1500 - 3000 XP (ì „ë¬¸ íƒí—˜ê°€)
Level 4: 3000 - 5000 XP (ë§ˆìŠ¤í„° íƒí—˜ê°€)
Level 5: 5000+ XP (ì „ì„¤ì˜ íƒí—˜ê°€)
```

## ğŸ”§ ë‹¤ìŒ ë‹¨ê³„ êµ¬í˜„ ê³„íš

### Phase 1: ìë™ ë°©ë¬¸ ê¸°ë¡ (ìš°ì„ ìˆœìœ„: ìµœê³ )

**ëª©í‘œ**: ì¶”ì²œ ì¥ì†Œ ë°©ë¬¸ ì‹œ ìë™ìœ¼ë¡œ ê¸°ë¡

**êµ¬í˜„ ìœ„ì¹˜**: `frontend-app/components/main-app-v3.tsx`

**í•„ìš”í•œ ê¸°ëŠ¥**:
1. í€˜ìŠ¤íŠ¸ ìˆ˜ë½ í™”ë©´ì— "ì²´í¬ì¸" ë²„íŠ¼ ì¶”ê°€
2. ì²´í¬ì¸ ì‹œ `POST /api/v1/visits` í˜¸ì¶œ
3. XP íšë“ ì•Œë¦¼ í‘œì‹œ
4. "ë‚˜ì˜ ì§€ë„" ë²„íŠ¼ ê°•ì¡° (ìƒˆ ê¸°ë¡ ì•Œë¦¼)

**ì˜ˆìƒ ì½”ë“œ**:
```typescript
const handleCheckIn = async () => {
  const response = await fetch('http://localhost:8000/api/v1/visits', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      user_id: userId,
      place_id: acceptedQuest.id,
      duration_minutes: 60, // ê¸°ë³¸ê°’ ë˜ëŠ” íƒ€ì´ë¨¸
      rating: null, // ë‚˜ì¤‘ì— ì…ë ¥
      mood: selectedMood,
      spent_amount: null,
      companions: 1
    })
  });
  
  const data = await response.json();
  
  // XP íšë“ ì•Œë¦¼
  alert(`+${data.xp_earned} XP íšë“!`);
  
  // ë‚˜ì˜ ì§€ë„ë¡œ ì´ë™
  router.push('/my-map-real');
};
```

### Phase 2: ë°©ë¬¸ í›„ ë¦¬ë·° (ìš°ì„ ìˆœìœ„: ë†’ìŒ)

**ëª©í‘œ**: ë°©ë¬¸ ì™„ë£Œ í›„ í‰ì ê³¼ í›„ê¸° ì‘ì„±

**í•„ìš”í•œ ê¸°ëŠ¥**:
1. ì²´í¬ì¸ í›„ ë¦¬ë·° ëª¨ë‹¬ í‘œì‹œ
2. ë³„ì  ì…ë ¥ (1-5)
3. ê°„ë‹¨í•œ í›„ê¸° ì‘ì„±
4. ì‚¬ì§„ ì—…ë¡œë“œ (ì„ íƒ)

### Phase 3: ì‹¤ì œ ì§€ë„ í†µí•© (ìš°ì„ ìˆœìœ„: ì¤‘ê°„)

**ëª©í‘œ**: Canvas ëŒ€ì‹  Kakao Map ì‚¬ìš©

**í•„ìš”í•œ ì‘ì—…**:
1. Kakao Map JavaScript API ì¶”ê°€
2. ë°©ë¬¸ ë§ˆì»¤ í‘œì‹œ
3. ê²½ë¡œ í‘œì‹œ
4. í˜„ì¬ ìœ„ì¹˜ í‘œì‹œ

### Phase 4: ì†Œì…œ ê¸°ëŠ¥ (ìš°ì„ ìˆœìœ„: ë‚®ìŒ)

**ëª©í‘œ**: ì¹œêµ¬ì™€ ê³µìœ , ë¹„êµ

**í•„ìš”í•œ ê¸°ëŠ¥**:
1. ì¹œêµ¬ ì´ˆëŒ€
2. ë°©ë¬¸ ê¸°ë¡ ê³µìœ 
3. íƒí—˜ ìŠ¤íƒ€ì¼ ë¹„êµ
4. í•¨ê»˜ ë°©ë¬¸í•œ ì¥ì†Œ í‘œì‹œ

## ğŸ› ë¬¸ì œ í•´ê²°

### ë¬¸ì œ: "No visits yet" ë©”ì‹œì§€

**ì›ì¸**: visits í…Œì´ë¸”ì´ ìƒì„±ë˜ì§€ ì•ŠìŒ

**í•´ê²°**:
1. Supabase SQL Editor ì ‘ì†
2. `CREATE_VISITS_TABLE.sql` ì‹¤í–‰
3. í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨

### ë¬¸ì œ: 500 Internal Server Error

**ì›ì¸**: ë°±ì—”ë“œ ì—ëŸ¬

**í•´ê²°**:
1. ë°±ì—”ë“œ í„°ë¯¸ë„ ë¡œê·¸ í™•ì¸
2. `.env` íŒŒì¼ í™•ì¸ (SUPABASE_URL, SUPABASE_SERVICE_ROLE_KEY)
3. ë°±ì—”ë“œ ì¬ì‹œì‘

### ë¬¸ì œ: ì§€ë„ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ

**ì›ì¸**: ë°©ë¬¸ ê¸°ë¡ì´ ì—†ìŒ

**í•´ê²°**:
1. Supabaseì—ì„œ ìƒ˜í”Œ ë°ì´í„° í™•ì¸
   ```sql
   SELECT COUNT(*) FROM visits WHERE user_id = 'user-demo-001';
   ```
2. 0ê°œë©´ `CREATE_VISITS_TABLE.sql` ì¬ì‹¤í–‰

### ë¬¸ì œ: Mock ë°ì´í„°ê°€ í‘œì‹œë¨

**ì›ì¸**: ì˜ëª»ëœ URL ì ‘ì†

**í•´ê²°**:
- âŒ `/my-map` (êµ¬ë²„ì „)
- âœ… `/my-map-real` (ì‹ ë²„ì „)

## ğŸ“Š API í…ŒìŠ¤íŠ¸

### ë°©ë¬¸ ê¸°ë¡ ì¡°íšŒ
```powershell
# PowerShell
Invoke-RestMethod -Uri "http://localhost:8000/api/v1/visits/user-demo-001" -Method Get
```

### ë°©ë¬¸ ê¸°ë¡ ìƒì„±
```powershell
# PowerShell
$body = @{
    user_id = "user-demo-001"
    place_id = "place-id-from-db"
    duration_minutes = 60
    rating = 4.5
    mood = "happy"
    spent_amount = 12000
    companions = 2
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:8000/api/v1/visits" -Method Post -Body $body -ContentType "application/json"
```

### íŒ¨í„´ ë¶„ì„
```powershell
# PowerShell
$body = @{
    user_id = "user-demo-001"
    days = 90
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:8000/api/v1/ai/pattern/analyze" -Method Post -Body $body -ContentType "application/json"
```

## ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì„¤ì • ì™„ë£Œ í™•ì¸
- [ ] Supabase visits í…Œì´ë¸” ìƒì„±
- [ ] ìƒ˜í”Œ ë°ì´í„° 7ê°œ í™•ì¸
- [ ] ë°±ì—”ë“œ ì‹¤í–‰ ì¤‘ (port 8000)
- [ ] í”„ë¡ íŠ¸ì—”ë“œ ì‹¤í–‰ ì¤‘ (port 3003)
- [ ] `/my-map-real` ì ‘ì† ì„±ê³µ
- [ ] ì§€ë„ì— 7ê°œ ë§ˆì»¤ í‘œì‹œ
- [ ] í†µê³„ íƒ­ ì •ìƒ ì‘ë™
- [ ] ìŠ¤íƒ€ì¼ íƒ­ ì •ìƒ ì‘ë™

### ë‹¤ìŒ êµ¬í˜„ í™•ì¸
- [ ] ì²´í¬ì¸ ë²„íŠ¼ ì¶”ê°€
- [ ] ë°©ë¬¸ ê¸°ë¡ ìë™ ìƒì„±
- [ ] XP íšë“ ì•Œë¦¼
- [ ] ë¦¬ë·° ì‘ì„± ê¸°ëŠ¥
- [ ] ì‹¤ì œ ì§€ë„ í†µí•©

## ğŸ¯ ì„±ê³µ ê¸°ì¤€

### ê¸°ëŠ¥
- âœ… ì‹¤ì œ DBì—ì„œ ë°©ë¬¸ ê¸°ë¡ ì¡°íšŒ
- âœ… AI íŒ¨í„´ ë¶„ì„
- âœ… ì¸í„°ë™í‹°ë¸Œ ì§€ë„
- âœ… ì‹¤ì‹œê°„ í†µê³„
- â³ ìë™ ë°©ë¬¸ ê¸°ë¡ ìƒì„± (ë‹¤ìŒ ë‹¨ê³„)

### ì„±ëŠ¥
- âœ… ë¡œë”© ì‹œê°„ < 2ì´ˆ
- âœ… ë¶€ë“œëŸ¬ìš´ ì• ë‹ˆë©”ì´ì…˜
- âœ… ì—ëŸ¬ í•¸ë“¤ë§

### UX
- âœ… ì§ê´€ì ì¸ ë„¤ë¹„ê²Œì´ì…˜
- âœ… ë°˜ì‘í˜• ë””ìì¸
- âœ… ì‹¤ì‹œê°„ í”¼ë“œë°±

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- `MY_MAP_REAL_DATA_INTEGRATION.md` - ìƒì„¸ ê¸°ìˆ  ë¬¸ì„œ
- `REAL_DATA_SETUP.md` - ì „ì²´ ì‹¤ì œ ë°ì´í„° ì„¤ì •
- `IMPLEMENTATION_GUIDE.md` - AI ì¶”ì²œ ì‹œìŠ¤í…œ ê°€ì´ë“œ
- `KAKAO_AI_ANALYSIS.md` - Kakao Map AI ë¶„ì„

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2024-02-14
**í˜„ì¬ ìƒíƒœ**: ë°±ì—”ë“œ/í”„ë¡ íŠ¸ì—”ë“œ ì™„ì„±, DB ë§ˆì´ê·¸ë ˆì´ì…˜ ëŒ€ê¸° ì¤‘
**ë‹¤ìŒ ë‹¨ê³„**: Supabaseì—ì„œ CREATE_VISITS_TABLE.sql ì‹¤í–‰
